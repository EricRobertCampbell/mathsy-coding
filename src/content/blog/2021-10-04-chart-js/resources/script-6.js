// script.js
const condensedData = 
[{"localName":"CROWSNEST PASS","population":6280,"percentFullyImmunized":58.1},{"localName":"PINCHER CREEK","population":8344,"percentFullyImmunized":57.7},{"localName":"FORT MACLEOD","population":6753,"percentFullyImmunized":44.3},{"localName":"CARDSTON-KAINAI","population":16595,"percentFullyImmunized":48.6},{"localName":"COUNTY OF LETHBRIDGE","population":25820,"percentFullyImmunized":44},{"localName":"TABER MD","population":19028,"percentFullyImmunized":34.9},{"localName":"COUNTY OF WARNER","population":11104,"percentFullyImmunized":42.9},{"localName":"COUNTY OF FORTY MILE","population":6409,"percentFullyImmunized":28.3},{"localName":"NEWELL","population":27753,"percentFullyImmunized":46.9},{"localName":"OYEN","population":3486,"percentFullyImmunized":45.9},{"localName":"CYPRESS COUNTY","population":11298,"percentFullyImmunized":48.6},{"localName":"MEDICINE HAT","population":68115,"percentFullyImmunized":57.4},{"localName":"LETHBRIDGE - WEST","population":38163,"percentFullyImmunized":65.7},{"localName":"LETHBRIDGE - NORTH","population":27903,"percentFullyImmunized":61.8},{"localName":"LETHBRIDGE - SOUTH","population":34464,"percentFullyImmunized":65.3},{"localName":"CALGARY - UPPER NW","population":123679,"percentFullyImmunized":69.4},{"localName":"CALGARY - NORTH","population":116945,"percentFullyImmunized":67.6},{"localName":"CALGARY - NOSE HILL","population":78021,"percentFullyImmunized":65.8},{"localName":"CALGARY - LOWER NW","population":62696,"percentFullyImmunized":71.2},{"localName":"CALGARY - WEST BOW","population":21283,"percentFullyImmunized":65.7},{"localName":"CALGARY - CENTRE NORTH","population":44910,"percentFullyImmunized":68.7},{"localName":"CALGARY - UPPER NE","population":120999,"percentFullyImmunized":63.9},{"localName":"CALGARY - LOWER NE","population":96472,"percentFullyImmunized":58.3},{"localName":"CALGARY - EAST","population":72509,"percentFullyImmunized":56.7},{"localName":"CALGARY - SE","population":134420,"percentFullyImmunized":64},{"localName":"CALGARY - WEST","population":92320,"percentFullyImmunized":69.3},{"localName":"CALGARY - CENTRE","population":67568,"percentFullyImmunized":66.5},{"localName":"CALGARY - CENTRE WEST","population":65845,"percentFullyImmunized":67.7},{"localName":"CALGARY - ELBOW","population":40834,"percentFullyImmunized":69.8},{"localName":"CALGARY - FISH CREEK","population":111574,"percentFullyImmunized":66.5},{"localName":"CALGARY - SW","population":116934,"percentFullyImmunized":66.5},{"localName":"OKOTOKS-PRIDDIS","population":46042,"percentFullyImmunized":60},{"localName":"BLACK DIAMOND","population":8769,"percentFullyImmunized":52.9},{"localName":"HIGH RIVER","population":23739,"percentFullyImmunized":56.1},{"localName":"CLARESHOLM","population":6246,"percentFullyImmunized":56.9},{"localName":"VULCAN","population":6775,"percentFullyImmunized":47},{"localName":"AIRDRIE","population":73698,"percentFullyImmunized":56.8},{"localName":"CHESTERMERE","population":25015,"percentFullyImmunized":63},{"localName":"STRATHMORE","population":35685,"percentFullyImmunized":54.8},{"localName":"CROSSFIELD","population":9164,"percentFullyImmunized":50.4},{"localName":"DIDSBURY","population":16475,"percentFullyImmunized":50.3},{"localName":"COCHRANE-SPRINGBANK","population":50816,"percentFullyImmunized":63.2},{"localName":"CANMORE","population":27674,"percentFullyImmunized":64.3},{"localName":"BANFF","population":13451,"percentFullyImmunized":57.7},{"localName":"ROCKY MOUNTAIN HOUSE","population":20389,"percentFullyImmunized":43.3},{"localName":"DRAYTON VALLEY","population":18075,"percentFullyImmunized":40.6},{"localName":"SUNDRE","population":6782,"percentFullyImmunized":47.6},{"localName":"OLDS","population":12597,"percentFullyImmunized":54.9},{"localName":"INNISFAIL","population":15939,"percentFullyImmunized":57.1},{"localName":"RED DEER COUNTY","population":29495,"percentFullyImmunized":43.6},{"localName":"SYLVAN LAKE","population":18013,"percentFullyImmunized":42.9},{"localName":"THREE HILLS/HIGHWAY 21","population":10816,"percentFullyImmunized":45.5},{"localName":"STARLAND COUNTY/DRUMHELLER","population":11802,"percentFullyImmunized":55.8},{"localName":"PLANNING & SPECIAL AREA 2","population":3648,"percentFullyImmunized":48},{"localName":"STETTLER & COUNTY","population":12520,"percentFullyImmunized":45.8},{"localName":"CASTOR/CORONATION/CONSORT","population":6160,"percentFullyImmunized":44.3},{"localName":"WETASKIWIN COUNTY","population":33715,"percentFullyImmunized":46.8},{"localName":"PONOKA","population":12399,"percentFullyImmunized":47.5},{"localName":"RIMBEY","population":10013,"percentFullyImmunized":44.3},{"localName":"LACOMBE","population":23417,"percentFullyImmunized":48.1},{"localName":"CAMROSE & COUNTY","population":30125,"percentFullyImmunized":57.8},{"localName":"TOFIELD","population":7797,"percentFullyImmunized":51.5},{"localName":"VIKING","population":2351,"percentFullyImmunized":55.5},{"localName":"FLAGSTAFF COUNTY","population":8426,"percentFullyImmunized":55.7},{"localName":"MD OF PROVOST","population":4860,"percentFullyImmunized":50.1},{"localName":"MD OF WAINWRIGHT","population":11915,"percentFullyImmunized":54},{"localName":"LAMONT COUNTY","population":6388,"percentFullyImmunized":52.6},{"localName":"TWO HILLS COUNTY","population":5579,"percentFullyImmunized":30.5},{"localName":"VEGREVILLE/MINBURN COUNTY","population":10323,"percentFullyImmunized":56.5},{"localName":"VERMILION RIVER COUNTY","population":36740,"percentFullyImmunized":27.9},{"localName":"RED DEER - NORTH","population":35640,"percentFullyImmunized":50},{"localName":"RED DEER - SW","population":15679,"percentFullyImmunized":51.1},{"localName":"RED DEER - EAST","population":55069,"percentFullyImmunized":57.3},{"localName":"EDMONTON - WOODCROFT EAST","population":60664,"percentFullyImmunized":59.9},{"localName":"EDMONTON - WOODCROFT WEST","population":33002,"percentFullyImmunized":63.2},{"localName":"EDMONTON - JASPER PLACE","population":46923,"percentFullyImmunized":59.6},{"localName":"EDMONTON - WEST JASPER PLACE","population":103462,"percentFullyImmunized":69.4},{"localName":"EDMONTON - CASTLE DOWNS","population":71594,"percentFullyImmunized":60.5},{"localName":"EDMONTON - NORTHGATE","population":82969,"percentFullyImmunized":59.1},{"localName":"EDMONTON - EASTWOOD","population":72156,"percentFullyImmunized":55.4},{"localName":"EDMONTON - ABBOTTSFIELD","population":14582,"percentFullyImmunized":50.5},{"localName":"EDMONTON - NE","population":90743,"percentFullyImmunized":57.6},{"localName":"EDMONTON - BONNIE DOON","population":96621,"percentFullyImmunized":67.6},{"localName":"EDMONTON - MILL WOODS WEST","population":51150,"percentFullyImmunized":62},{"localName":"EDMONTON - MILL WOODS SOUTH & EAST","population":85232,"percentFullyImmunized":65.1},{"localName":"EDMONTON - DUGGAN","population":40132,"percentFullyImmunized":66.6},{"localName":"EDMONTON - TWIN BROOKS","population":75969,"percentFullyImmunized":72.3},{"localName":"EDMONTON - RUTHERFORD","population":112265,"percentFullyImmunized":66.5},{"localName":"STURGEON COUNTY WEST","population":30154,"percentFullyImmunized":55.1},{"localName":"STURGEON COUNTY EAST","population":6095,"percentFullyImmunized":55.2},{"localName":"FORT SASKATCHEWAN","population":26795,"percentFullyImmunized":58.8},{"localName":"SHERWOOD PARK","population":82033,"percentFullyImmunized":70.1},{"localName":"STRATHCONA COUNTY EXCLUDING SHERWOOD PARK","population":17420,"percentFullyImmunized":63.1},{"localName":"BEAUMONT","population":25785,"percentFullyImmunized":59.6},{"localName":"LEDUC & DEVON","population":43021,"percentFullyImmunized":56.8},{"localName":"THORSBY","population":9090,"percentFullyImmunized":48.6},{"localName":"STONY PLAIN & SPRUCE GROVE","population":57833,"percentFullyImmunized":58},{"localName":"WESTVIEW EXCLUDING STONY PLAIN & SPRUCE GROVE","population":36730,"percentFullyImmunized":51.6},{"localName":"ST. ALBERT","population":69588,"percentFullyImmunized":70.5},{"localName":"JASPER","population":5592,"percentFullyImmunized":68},{"localName":"HINTON","population":12260,"percentFullyImmunized":53.3},{"localName":"EDSON","population":16050,"percentFullyImmunized":47.5},{"localName":"WHITECOURT","population":14719,"percentFullyImmunized":44.7},{"localName":"MAYERTHORPE","population":16200,"percentFullyImmunized":48.8},{"localName":"BARRHEAD","population":10948,"percentFullyImmunized":47.9},{"localName":"WESTLOCK","population":19168,"percentFullyImmunized":53.8},{"localName":"FROG LAKE","population":4827,"percentFullyImmunized":34.8},{"localName":"ST. PAUL","population":15522,"percentFullyImmunized":39.2},{"localName":"SMOKY LAKE","population":4728,"percentFullyImmunized":51.3},{"localName":"COLD LAKE","population":20716,"percentFullyImmunized":46.4},{"localName":"BONNYVILLE","population":16602,"percentFullyImmunized":42.2},{"localName":"BOYLE","population":3544,"percentFullyImmunized":44.4},{"localName":"ATHABASCA","population":10686,"percentFullyImmunized":55.1},{"localName":"LAC LA BICHE","population":10392,"percentFullyImmunized":43.6},{"localName":"GRANDE CACHE","population":4168,"percentFullyImmunized":44.8},{"localName":"FOX CREEK","population":2241,"percentFullyImmunized":45.7},{"localName":"VALLEYVIEW","population":7226,"percentFullyImmunized":39.6},{"localName":"BEAVERLODGE","population":12199,"percentFullyImmunized":40.5},{"localName":"GRANDE PRAIRIE COUNTY","population":20862,"percentFullyImmunized":42.6},{"localName":"SWAN HILLS","population":1336,"percentFullyImmunized":45.4},{"localName":"SLAVE LAKE","population":11676,"percentFullyImmunized":41.9},{"localName":"WABASCA","population":4238,"percentFullyImmunized":34.2},{"localName":"HIGH PRAIRIE","population":11613,"percentFullyImmunized":33.8},{"localName":"HIGH LEVEL","population":25086,"percentFullyImmunized":14.1},{"localName":"MANNING","population":3290,"percentFullyImmunized":40.2},{"localName":"PEACE RIVER","population":18611,"percentFullyImmunized":42.5},{"localName":"FALHER","population":4427,"percentFullyImmunized":48.1},{"localName":"SPIRIT RIVER","population":6114,"percentFullyImmunized":40.7},{"localName":"FAIRVIEW","population":8131,"percentFullyImmunized":39.9},{"localName":"WOOD BUFFALO","population":4062,"percentFullyImmunized":34.5},{"localName":"FORT MCMURRAY","population":79416,"percentFullyImmunized":50},{"localName":"CITY OF GRANDE PRAIRIE","population":74275,"percentFullyImmunized":43.3}]

const orderedData = condensedData.sort((a, b) => a.percentFullyImmunized - b.percentFullyImmunized)

function generateColourInRedGreenIntervalByProportion(prop) {
	return `rgb(255, ${255 * prop}, 0)`;
}

function setup() {
	const ctx = document.getElementById('graph').getContext('2d')
	const options = {
		type: 'scatter',
		data: {
			datasets: [
				{
					label: 'Health Regions',
					data: orderedData.map(item => ({x: item.population,  y: item.percentFullyImmunized, label: item.localName } )),
					backgroundColor: orderedData.map(item => generateColourInRedGreenIntervalByProportion(item.percentFullyImmunized / 100))
				}
			]
		},
		options: {
			scales: {
				x: {
					type: 'linear',
					title: {
						display: true,
						text: 'Population',
					}
				}, 
				y: {
					type: 'linear',
					title: {
						display: true,
						text: 'Percentage Fully Vaccinated',
					}
				}
			},
			plugins: {
				title: {
					display: true,
					text: 'Percent Vaccination for Alberta Regions',
				},
				tooltip: {
					callbacks: {
						label: (context) => context.raw.label ? context.raw.label : '',
					}
				}
			},
		},
	};
	const chart = new Chart(ctx, options)
}

window.onload = setup
